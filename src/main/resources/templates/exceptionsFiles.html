<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Excepciones archivos</title>
    <meta charset="UTF-8">
	<!-- Bootstrap CDN -->
  	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
	<!-- Panel de excepciones -->
	<div th:replace="~{fragments/exceptionHeader :: exceptionHeader}"></div>
	
	<!-- Excepciones con ficheros -->
	<h2>Excepciones de apretura y lectura de archivos.</h2>
	
	<!-- 
		Las excepciones se prueban en 
		un ejemlo de gestiÃ³n de archivos 
		listados por el servidor
	-->
	
	<!-- Lista de ficheros -->
	<div th:if="${error}">
        <p style="color: red;">[[${error}]]</p>
    </div>

	<div class="container-fluid mt-4">
            <table class="table table-striped table-bordered table-hover" style="width: 50%; margin-left: 0;">
	        <thead class="table-dark">
	            <tr>
	                <th>Archivo</th>
	                <th>Opciones</th>
	            </tr>
	        </thead>
	        <tbody>
	            <tr th:each="file : ${files}">
	                <td th:text="${file}"></td>
	                <td>
	                    <form th:action="@{/file/read}" method="GET" class="d-inline">
	                        <input type="hidden" name="filename" th:value="${file}" />
	                        <button type="submit" class="btn btn-info btn-sm">Leer</button>
	                    </form>
	                    <form th:action="@{/file/write}" method="POST" class="d-inline">
	                        <input type="hidden" name="filename" th:value="${file}" />
	                        <button type="submit" class="btn btn-success btn-sm">Escribir</button>
	                    </form>
	                </td>
	            </tr>
	        </tbody>
	    </table>
	</div>

	
	<!-- Caso de reqiest exitosa -->
	<div th:if="${readSuccess} or ${writeSuccess}">
		<h3>Codigo de respuesta: [[${httpStatus}]]</h3>
	    <h3>Contenido de [[${filename}]]:</h3>
	    <p th:text="${content}"></p>
		<a th:href="@{/file/list}">Volver a la lista de archivos</a>
	</div>
	
	<!-- Caso de error en la request -->
	<div th:if="${errorCode}">
	    <h3>Error: [[${errorCode}]]</h3>
		<h3>Codigo de respuesta: [[${httpStatus}]]</h3>
	    <p th:text="${errorMessage}"></p>
		<a th:href="@{/file/list}">Volver a la lista de archivos</a>
	</div>
	
	<!-- Footer -->
    <div th:replace="~{fragments/footer :: footer}"></div>
</body>
</html>